# Test for HashiCorp Vault secret backend

statement ok
CREATE SECRET vault_secret
WITH (
  backend = 'hashicorp_vault',
  addr = 'https://vault.example.com:8200',
  path = 'secret/data/myapp/db',
  field = 'password',
  auth_method = 'token',
  auth_token = 'hvs.test_token_123',
  tls_skip_verify = 'true',
  cache_ttl_secs = '300'
) AS NULL;

statement ok
SHOW SECRETS;

# Test with app role auth
statement ok
CREATE SECRET vault_secret_approle
WITH (
  backend = 'hashicorp_vault',
  addr = 'https://vault.example.com:8200',
  path = 'secret/data/myapp/api_key',
  auth_method = 'approle',
  auth_role_id = 'test-role-id',
  auth_secret_id = 'test-secret-id'
) AS NULL;

statement ok
SHOW SECRETS;

# Drop secrets
statement ok
DROP SECRET vault_secret;

statement ok
DROP SECRET vault_secret_approle;

statement ok
SHOW SECRETS;
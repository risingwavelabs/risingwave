# Test error handling for secret references in function parameters

# Create test secrets
statement ok
CREATE SECRET valid_secret WITH (backend = 'meta') AS 'secret_value';

# Test error: secret does not exist
statement error
SELECT length(secret nonexistent_secret);
----

# Test error: invalid secret reference syntax
statement error
SELECT length(secret);
----

# Test error: secret in wrong context (not a function arg)
# This should fail during binding as SecretRefExpr is only valid in function args
statement error
SELECT secret valid_secret FROM (SELECT 1) t;
----

# Test error: accessing non-existent schema qualified secret
statement error
SELECT length(secret public.nonexistent_secret);
----

# Clean up
statement ok
DROP SECRET valid_secret;

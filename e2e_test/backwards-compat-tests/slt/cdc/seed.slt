# mysql

system ok
mysql --host=127.0.0.1 --port=4306 -u root -D rwcdc << EOF
CREATE TABLE table_in_mysql (
    id INT PRIMARY KEY,
    name VARCHAR(255)
);
INSERT INTO table_in_mysql VALUES (1,'11'),(2,'22');
EOF

statement ok
CREATE SOURCE cdc_source_mysql WITH (
    connector = 'mysql-cdc',
    hostname='127.0.0.1',
    port=4306,
    database.name='rwcdc',
    username='root',
    password='',
    auto.schema.change = 'true'
);

statement ok
CREATE TABLE mysql_table_in_rw (
    id INT PRIMARY KEY,
    name VARCHAR
)
FROM cdc_source_mysql TABLE 'rwcdc.table_in_mysql';


# postgres

system ok
PGPASSWORD=postgres psql -h 127.0.0.1 -p 8432 -d rwcdc -U postgres << EOF
CREATE TABLE table_in_postgres (
    id INT PRIMARY KEY,
    name VARCHAR(255)
);
INSERT INTO table_in_postgres VALUES (1,'11'),(2,'22');
EOF

statement ok
CREATE SOURCE cdc_source_postgres WITH (
    connector = 'postgres-cdc',
    hostname='127.0.0.1',
    port=8432,
    database.name='rwcdc',
    username='postgres',
    password='',
    auto.schema.change = 'true'
);

statement ok
CREATE TABLE postgres_table_in_rw (
    id INT PRIMARY KEY,
    name VARCHAR
)
FROM cdc_source_postgres TABLE 'public.table_in_postgres';

# sqlserver

system ok
SQLCMDSERVER=127.0.0.1 SQLCMDUSER=SA SQLCMDPASSWORD="YourPassword123" SQLCMDDBNAME=master SQLCMDPORT=1433 sqlcmd <<EOF
CREATE DATABASE rwcdc;
GO
USE rwcdc;
GO
EXEC sp_changedbowner 'SA';
GO
EXEC sys.sp_cdc_enable_db;
GO
CREATE TABLE table_in_sqlserver (
    id INT PRIMARY KEY,
    name VARCHAR(255)
);
GO
EXEC sys.sp_cdc_enable_table
  @source_schema = 'dbo',
  @source_name = 'table_in_sqlserver',
  @role_name = NULL;
GO
INSERT INTO table_in_sqlserver VALUES (1,'11'),(2,'22');
GO
EOF

statement ok
CREATE SOURCE cdc_source_sqlserver WITH (
    connector = 'sqlserver-cdc',
    hostname = '127.0.0.1',
    port = '1433',
    username = 'SA',
    password = 'YourPassword123',
    database.name = 'rwcdc',
);

statement ok
CREATE TABLE sqlserver_table_in_rw (
    id INT PRIMARY KEY,
    name VARCHAR
)
FROM cdc_source_sqlserver TABLE 'rwcdc.dbo.table_in_sqlserver';

# wait for all cdc backfill to complete
sleep 3s
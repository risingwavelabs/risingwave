statement ok
set streaming_use_snapshot_backfill = true;

statement ok
create table stream(id1 int, a1 int, b1 int, v1 timestamp with time zone, watermark for v1 as v1 - INTERVAL '10' SECOND) APPEND ONLY;

statement ok
create table version(id2 int, a2 int, b2 int, primary key (id2));

statement error Temporal join with snapshot backfill not supported
create materialized view temporal_join_mv as select id1, a1, id2, v1 from stream left join version FOR SYSTEM_TIME AS OF PROCTIME() on id1 = id2;

statement ok
drop table version;

statement ok
drop table stream;

# include ../../batch/./catalog/rw_depend.slt.part
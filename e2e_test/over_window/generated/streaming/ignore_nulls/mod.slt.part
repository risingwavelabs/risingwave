# This file is generated by `gen.py`. Do not edit it manually!

# Test `IGNORE NULLS` in window function argument lists.

statement ok
create table t (ts timestamptz, val int);

statement ok
create materialized view v as
select
    *,
    first_value(val) over (partition by 1::int order by ts) as first,
    first_value(val ignore nulls) over (partition by 1::int order by ts) as first_non_null,
    first_value(val ignore nulls) over (partition by 1::int order by ts rows between 1 preceding and 1 following) as first_non_null_2,
    last_value(val) over (partition by 1::int order by ts) as last,
    last_value(val ignore nulls) over (partition by 1::int order by ts) as last_non_null,
    last_value(val ignore nulls) over (partition by 1::int order by ts rows between 1 preceding and 1 following) as last_non_null_2
from t;

statement ok
insert into t values
  ('2024-12-18T12:00:42Z', 3)
, ('2024-12-18T12:01:00Z', 2)
, ('2024-12-18T12:01:15Z', null);

query iiii
select first, first_non_null, first_non_null_2, last, last_non_null, last_non_null_2 from v order by ts;
----
3    3    3    3    3    2
3    3    3    2    2    2
3    3    2    NULL 2    2

statement ok
insert into t values
  ('2024-12-18T12:03:00Z', null)
, ('2024-12-18T12:12:00Z', 7);

query iiii
select first, first_non_null, first_non_null_2, last, last_non_null, last_non_null_2 from v order by ts;
----
3    3    3    3    3    2
3    3    3    2    2    2
3    3    2    NULL 2    2
3    3    7    NULL 2    7
3    3    7    7    7    7

statement ok
drop materialized view v;

statement ok
drop table t;

statement ok
SET RW_IMPLICIT_FLUSH TO true;

statement ok
SET sink_decouple TO true;

statement ok
create table t(v1 int);

statement ok
insert into t select * from generate_series(1, 10000);

statement ok
set backfill_rate_limit=1000;

statement ok
CREATE SINK sink1 AS select * from t WITH (
    connector = 'blackhole'
);

query I
select background_ddl from rw_catalog.rw_sinks where name='sink1';
----
f

statement ok
set background_ddl=true;

statement ok
CREATE SINK sink2 AS select * from t WITH (
    connector = 'blackhole'
);

query I
select background_ddl from rw_catalog.rw_sinks where name='sink2';
----
t

statement ok
drop sink sink1;

statement ok
drop sink sink2;

statement ok
drop table t cascade;

statement ok
set background_ddl=false;

statement ok
set backfill_rate_limit=default;


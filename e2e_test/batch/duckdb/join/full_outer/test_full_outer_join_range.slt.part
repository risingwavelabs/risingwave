# Copied from https://github.com/duckdb/duckdb (MIT licensed).
# Copyright 2018-2022 Stichting DuckDB Foundation 

# description: Test range FULL OUTER JOIN

statement ok
SET RW_IMPLICIT_FLUSH TO true;

statement ok
SET CREATE_COMPACTION_GROUP_FOR_MV TO true;

statement ok
CREATE TABLE integers(i INTEGER, j INTEGER);

statement ok
INSERT INTO integers VALUES (1, 1);

statement ok
CREATE TABLE integers2(k INTEGER, l INTEGER);

statement ok
INSERT INTO integers2 VALUES (1, 10);

# range join
query IIII
SELECT i, j, k, l FROM integers FULL OUTER JOIN integers2 ON integers.i<integers2.k ORDER BY 1, 2, 3, 4;
----
1	1	NULL	NULL
NULL	NULL	1	10

# empty RHS
query IIII
SELECT i, j, k, l FROM integers FULL OUTER JOIN (SELECT * FROM integers2 WHERE 1=0) integers2 ON integers.i<integers2.k ORDER BY 1, 2, 3, 4;
----
1	1	NULL	NULL

statement ok
DROP TABLE integers;

statement ok
DROP TABLE integers2;

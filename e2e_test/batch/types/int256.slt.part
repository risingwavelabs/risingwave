statement ok
SET RW_IMPLICIT_FLUSH TO true;

query I
select '1'::rw_int256 + '100000000000000000000000000000000'::rw_int256;
----
100000000000000000000000000000001

query I
select '1'::rw_int256 + '-100000000000000000000000000000000'::rw_int256;
----
-99999999999999999999999999999999

query I
select '100000000000000000000000000000000'::rw_int256 - '1'::rw_int256;
----
99999999999999999999999999999999

query I
select '10000000000000000'::rw_int256 * '10000000000000000'::rw_int256;
----
100000000000000000000000000000000

query I
select '-10000000000000000'::rw_int256 * '10000000000000000'::rw_int256;
----
-100000000000000000000000000000000

query I
select '100000000000000000000000000000000'::rw_int256 / '1'::rw_int256;
----
100000000000000000000000000000000

query I
select '100000000000000000000000000000000'::rw_int256 / '-1'::rw_int256;
----
-100000000000000000000000000000000

query I
select '10000000000000000'::rw_int256 % '2'::rw_int256;
----
0

query I
select '10000000000000000'::rw_int256 % '-2'::rw_int256;
----
0

query R
select '1'::rw_int256 / 2::float8;
----
0.5

query R
select '1'::rw_int256 / 3::double precision;
----
0.3333333333333333

query R
select '10000000000000000'::rw_int256 / 2::double precision;
----
5000000000000000

query I
select abs('-10000000000000000'::rw_int256);
----
10000000000000000

query I
select -('-10000000000000000'::rw_int256);
----
10000000000000000

query I
select hex_to_int256('0x11');
----
17

query I
select hex_to_int256('-0x11');
----
-17

query I
select hex_to_int256('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff');
----
7237005577332262213973186563042994240829374041602535252466099000494570602495


statement ok
create table t (v rw_int256)

statement ok
insert into t values (1), (100), (10000), (100000000), (10000000000000000), ('100000000000000000000000000000000');

query I rowsort
select * from t;
----
1
100
10000
100000000
10000000000000000
100000000000000000000000000000000

statement ok
insert into t values (0);

statement ok
insert into t values (-1), (-100), (-10000), (-100000000), (-10000000000000000), ('-100000000000000000000000000000000');

query I
select * from t order by v asc;
----
-100000000000000000000000000000000
-10000000000000000
-100000000
-10000
-100
-1
0
1
100
10000
100000000
10000000000000000
100000000000000000000000000000000

query I
select * from t order by v desc;
----
100000000000000000000000000000000
10000000000000000
100000000
10000
100
1
0
-1
-100
-10000
-100000000
-10000000000000000
-100000000000000000000000000000000

query I rowsort
select * from t where v > 0;
----
1
100
10000
100000000
10000000000000000
100000000000000000000000000000000

query B
select 1::rw_int256 is null;
----
f

query I
select distinct v::rw_int256 from generate_series(1, 1, 1) as t(v);
----
1

statement ok
drop table t;

query TT
select v::varchar, pg_typeof(v) from (select 1::rw_int256 / 1::float8) as t(v);
----
1 double precision

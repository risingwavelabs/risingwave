statement ok
CREATE TABLE t1 (i1 int, i2 varchar, i3 varchar);

statement ok
INSERT INTO t1 select key, 'some long string of text', 'another long string of text' from generate_series(1, 1000000) as key;

statement ok
CREATE SINK sink1 AS select * from t1 WITH (
    connector = 'iceberg',
    type = 'append-only',
    force_append_only = 'true',
    database.name = 'demo_db',
    table.name = 't1',
    catalog.name = 'demo',
    catalog.type = 'storage',
    warehouse.path = 's3a://icebergdata/demo',
    s3.endpoint = 'http://127.0.0.1:9301',
    s3.region = 'us-east-1',
    s3.access.key = 'hummockadmin',
    s3.secret.key = 'hummockadmin',
    commit_checkpoint_interval = 1,
    create_table_if_not_exists = 'true'
);

statement ok
CREATE SOURCE iceberg_t1_source
WITH (
    connector = 'iceberg',
    s3.endpoint = 'http://127.0.0.1:9301',
    s3.region = 'us-east-1',
    s3.access.key = 'hummockadmin',
    s3.secret.key = 'hummockadmin',
    s3.path.style.access = 'true',
    catalog.type = 'storage',
    warehouse.path = 's3a://icebergdata/demo',
    database.name = 'demo_db',
    table.name = 't1',
);

statement ok
flush;

query I
select count(*) from iceberg_t1_source;
----
1000000

# warmup
include ./bench_predicate_pushdown/point_get.slt.part
# bench
include ./bench_predicate_pushdown/point_get.slt.part

# warmup
include ./bench_predicate_pushdown/filter.slt.part
# bench
include ./bench_predicate_pushdown/filter.slt.part

statement ok
DROP SINK sink1;

statement ok
DROP SOURCE iceberg_t1_source;

statement ok
DROP TABLE t1 cascade;
statement ok
SET RW_IMPLICIT_FLUSH TO true;

statement ok
create table t(v1 int);

statement ok
INSERT INTO t select * from generate_series(1, 1000);

statement ok
set backfill_rate_limit=100;

statement ok
set background_ddl=true;

statement ok
CREATE MATERIALIZED VIEW m1 as SELECT * FROM t;

query I
select status from rw_catalog.rw_materialized_views where name='m1';
----
Creating

statement ok
wait;

query I
select status from rw_catalog.rw_materialized_views where name='m1';
----
Created

query I
select count(*) from m1;
----
1000

statement ok
DROP MATERIALIZED VIEW m1;

statement ok
DROP TABLE t;
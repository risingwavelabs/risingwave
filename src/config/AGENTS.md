# AGENTS.md - RisingWave Configuration Files Directory

## 1. Scope

Configuration files directory for RisingWave node settings. Not a Rust crate. Contains TOML configuration files consumed by RisingWave binaries via `--config-path` argument.

## 2. Purpose

Stores `risingwave.toml` configuration templates, CI-specific configurations, and auto-generated documentation for RisingWave system tuning. Configurations here override default values defined in `src/common/src/config.rs`.

## 3. Structure

```
src/config/
├── example.toml              # Auto-generated full configuration reference
├── docs.md                   # Auto-generated config documentation
├── README.md                 # Usage instructions for developers
├── serving-only.toml         # Template for serving-only compute nodes
├── ci.toml                   # Main CI test configuration
├── ci-*.toml                 # Specialized CI configurations (24 files)
│   ├── ci-recovery.toml
│   ├── ci-sim.toml
│   ├── ci-backfill.toml
│   ├── ci-ldap-*.toml
│   └── ...
└── .gitignore                # Ignores *.user.toml files
```

## 4. Key Files

| File | Purpose |
|------|---------|
| `example.toml` | Complete configuration template with all default values; generated by `./risedev generate-example-config` |
| `docs.md` | Auto-generated markdown documentation of all config options and defaults |
| `README.md` | Developer guide for using configs with RiseDev |
| `ci.toml` | Primary CI test configuration; disables recovery, tunes barriers |
| `serving-only.toml` | Memory allocation template for serving-only deployments |

## 5. Edit Rules (Must)

- Run `./risedev generate-example-config` after modifying config structs in `src/common/src/config.rs`
- Run `./risedev generate-docs` to regenerate `docs.md` when config definitions change
- CI configs must explicitly set `disable_recovery = true` for deterministic tests (unless testing recovery)
- Comments in CI configs must reference related test files when checkpoint settings change
- `example.toml` and `docs.md` are auto-generated: DO NOT edit manually

## 6. Forbidden Changes (Must Not)

- Manually edit `example.toml` or `docs.md` (they are auto-generated)
- Delete CI config files without updating `risedev.yml` profiles that reference them
- Add secrets or credentials to any committed `.toml` file
- Commit `*.user.toml` files (they are gitignored for local overrides)

## 7. Test Entry

| Test Type | Config Used |
|-----------|-------------|
| Standard CI | `ci.toml` |
| Recovery tests | `ci-recovery.toml` |
| Simulation tests | `ci-sim.toml`, `ci-sim-log-store.toml` |
| Compaction tests | `ci-compaction-test.toml`, `ci-compaction-test-meta.toml` |
| LDAP tests | `ci-ldap-*.toml` (5 variants) |
| Backfill tests | `ci-backfill.toml` |
| Time travel tests | `ci-time-travel.toml` |

## 8. Dependencies & Contracts

- Consumed by: RisingWave meta, compute, frontend, compactor binaries
- Source of truth for defaults: `src/common/src/config.rs`
- RiseDev integration: `config-path` in `risedev.yml` profiles references files here
- Generation commands: `./risedev generate-example-config`, `./risedev generate-docs`

## 9. Overrides

None. Inherits all rules from repository root `AGENTS.md`.

## 10. Update Triggers

Regenerate this file when:
- New CI configuration scenario requires additional `ci-*.toml` file
- Config generation commands change (e.g., `./risedev generate-example-config` renamed)
- Directory structure changes (e.g., new subdirectories added)

## 11. Metadata

- Created: 2025-02-22
- Version: 1.0
- Parent: `/home/k11/risingwave/AGENTS.md`

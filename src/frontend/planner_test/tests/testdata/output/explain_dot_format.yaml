# This file is automatically generated. See `src/frontend/planner_test/README.md` for more information.
- name: test dot output format (logical)
  sql: |
    CREATE TABLE t (v1 int);
    explain (logical, format dot) SELECT approx_percentile(0.5) WITHIN GROUP (order by v1) from t;
  explain_output: |
    digraph {
        0 [ label = "LogicalAgg\lid: \"2\"\laggs: [\"approx_percentile($expr1)\"]\l" ]
        1 [ label = "LogicalProject\lid: \"1\"\lexprs: [\"t.v1::Float64 as $expr1\"]\l" ]
        2 [ label = "LogicalScan\lid: \"10017\"\ltable: \"t\"\lcolumns: [\"v1\"]\l" ]
        0 -> 1 [ ]
        1 -> 2 [ ]
    }
- name: test dot output format (batch)
  sql: |
    CREATE TABLE t (v1 int);
    explain (physical, format dot) SELECT approx_percentile(0.5) WITHIN GROUP (order by v1) from t;
  explain_output: |
    digraph {
        0 [ label = "BatchSimpleAgg\lid: \"3\"\laggs: [\"approx_percentile($expr1)\"]\l" ]
        1 [ label = "BatchExchange\lid: \"2\"\lorder: []\ldist: \"Single\"\l" ]
        2 [ label = "BatchProject\lid: \"1\"\lexprs: [\"t.v1::Float64 as $expr1\"]\l" ]
        3 [ label = "BatchScan\lid: \"10033\"\ltable: \"t\"\lcolumns: [\"v1\"]\l" ]
        0 -> 1 [ ]
        1 -> 2 [ ]
        2 -> 3 [ ]
    }
- name: test dot output format (stream)
  sql: |
    CREATE TABLE t (v1 int);
    explain (physical, format dot) create materialized view m1 as SELECT approx_percentile(0.5) WITHIN GROUP (order by v1) from t;
  explain_output: |
    digraph {
        0 [ label = "StreamMaterialize\lid: \"3\"\lcolumns: [\"approx_percentile\"]\lstream_key: []\lpk_columns: []\lpk_conflict: \"NoCheck\"\l" ]
        1 [ label = "StreamGlobalApproxPercentile\lid: \"10046\"\lquantile: \"0.5:Float64\"\lrelative_error: \"0.01:Float64\"\l" ]
        2 [ label = "StreamExchange\lid: \"2\"\ldist: \"Single\"\l" ]
        3 [ label = "StreamLocalApproxPercentile\lid: \"10044\"\lpercentile_col: \"$expr1\"\lquantile: \"0.5:Float64\"\lrelative_error: \"0.01:Float64\"\l" ]
        4 [ label = "StreamProject\lid: \"1\"\lexprs: [\"t.v1::Float64 as $expr1\",\"t._row_id\"]\l" ]
        5 [ label = "StreamTableScan\lid: \"10049\"\ltable: \"t\"\lcolumns: [\"v1\",\"_row_id\"]\l" ]
        0 -> 1 [ ]
        1 -> 2 [ ]
        2 -> 3 [ ]
        3 -> 4 [ ]
        4 -> 5 [ ]
    }
- name: test long dot output format (stream)
  sql: |
    create table t1(a int, b int);
    create table t2(c int primary key, d int);
    explain (physical, format dot) create materialized view m1 as SELECT
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col1,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col2,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col3,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col4,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col5,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col6,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col7,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col8,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col9,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col10,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col11,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col12,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col13,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col14,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col15,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col16,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col17,
    COALESCE((SELECT b FROM t2 WHERE t1.a = t2.c), 0) col18
    from t1;
  explain_output: |
    digraph {
        0 [ label = "StreamMaterialize\lid: \"148\"\lcolumns: [\"col1\",\"col2\",\"col3\",\"col4\",\"col5\",\"col6\",\"col7\",\"col8\",\"col9\",\"col10\",\"col11\",\"col12\",\"col13\",\"col14\",\"col15\",\"col16\",\"col17\",\"col18\",\"t1._row_id(hidden)\",\"t1.b(hidden)\",\"t1.a(hidden)\",\"t1.a#1(hidden)\",\"t1.a#2(hidden)\",\"t1.a#3(hidden)\",\"t1.a#4(hidden)\",\"t1.a#5(hidden)\",\"t1.a#6(hidden)\",\"t1.a#7(hidden)\",\"t1.a#8(hidden)\",\"t1.a#9(hidden)\",\"t1.a#10(hidden)\",\"t1.a#11(hidden)\",\"t1.a#12(hidden)\",\"t1.a#13(hidden)\",\"t1.a#14(hidden)\",\"t1.a#15(hidden)\",\"t1.a#16(hidden)\",\"t1.a#17(hidden)\",\"t1.b#1(hidden)\"]\lstream_key: [\"t1._row_id\",\"t1.b\",\"t1.a\",\"t1.a#1\",\"t1.a#2\",\"t1.a#3\",\"t1.a#4\",\"t1.a#5\",\"t1.a#6\",\"t1.a#7\",\"t1.a#8\",\"t1.a#9\",\"t1.a#10\",\"t1.a#11\",\"t1.a#12\",\"t1.a#13\",\"t1.a#14\",\"t1.a#15\",\"t1.a#16\",\"t1.a#17\",\"t1.b#1\"]\lpk_columns: [\"t1._row_id\",\"t1.b\",\"t1.a\",\"t1.a#1\",\"t1.a#2\",\"t1.a#3\",\"t1.a#4\",\"t1.a#5\",\"t1.a#6\",\"t1.a#7\",\"t1.a#8\",\"t1.a#9\",\"t1.a#10\",\"t1.a#11\",\"t1.a#12\",\"t1.a#13\",\"t1.a#14\",\"t1.a#15\",\"t1.a#16\",\"t1.a#17\",\"t1.b#1\"]\lpk_conflict: \"NoCheck\"\l" ]
        1 [ label = "StreamProject\lid: \"147\"\lexprs: [\"Coalesce(t1.b, 0:Int32) as $expr1\",\"Coalesce(t1.b, 0:Int32) as $expr2\",\"Coalesce(t1.b, 0:Int32) as $expr3\",\"Coalesce(t1.b, 0:Int32) as $expr4\",\"Coalesce(t1.b, 0:Int32) as $expr5\",\"Coalesce(t1.b, 0:Int32) as $expr6\",\"Coalesce(t1.b, 0:Int32) as $expr7\",\"Coalesce(t1.b, 0:Int32) as $expr8\",\"Coalesce(t1.b, 0:Int32) as $expr9\",\"Coalesce(t1.b, 0:Int32) as $expr10\",\"Coalesce(t1.b, 0:Int32) as $expr11\",\"Coalesce(t1.b, 0:Int32) as $expr12\",\"Coalesce(t1.b, 0:Int32) as $expr13\",\"Coalesce(t1.b, 0:Int32) as $expr14\",\"Coalesce(t1.b, 0:Int32) as $expr15\",\"Coalesce(t1.b, 0:Int32) as $expr16\",\"Coalesce(t1.b, 0:Int32) as $expr17\",\"Coalesce(t1.b, 0:Int32) as $expr18\",\"t1._row_id\",\"t1.b\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.b\"]\l" ]
        2 [ label = "StreamHashJoin\lid: \"146\"\ltype: \"LeftOuter\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        3 [ label = "StreamExchange\lid: \"1\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        4 [ label = "StreamTableScan\lid: \"12158\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        5 [ label = "StreamExchange\lid: \"145\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        6 [ label = "StreamProject\lid: \"144\"\lexprs: [\"t1.a\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.b\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\",\"t1.a\"]\l" ]
        7 [ label = "StreamHashJoin\lid: \"143\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        8 [ label = "StreamExchange\lid: \"141\"\ldist: \"HashShard(t1.a)\"\l" ]
        9 [ label = "StreamHashJoin\lid: \"140\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        10 [ label = "StreamExchange\lid: \"136\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        11 [ label = "StreamHashJoin\lid: \"135\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        12 [ label = "StreamExchange\lid: \"133\"\ldist: \"HashShard(t1.a)\"\l" ]
        13 [ label = "StreamHashJoin\lid: \"132\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        14 [ label = "StreamExchange\lid: \"128\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        15 [ label = "StreamHashJoin\lid: \"127\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        16 [ label = "StreamExchange\lid: \"125\"\ldist: \"HashShard(t1.a)\"\l" ]
        17 [ label = "StreamHashJoin\lid: \"124\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        18 [ label = "StreamExchange\lid: \"120\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        19 [ label = "StreamHashJoin\lid: \"119\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        20 [ label = "StreamExchange\lid: \"117\"\ldist: \"HashShard(t1.a)\"\l" ]
        21 [ label = "StreamHashJoin\lid: \"116\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        22 [ label = "StreamExchange\lid: \"112\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        23 [ label = "StreamHashJoin\lid: \"111\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        24 [ label = "StreamExchange\lid: \"109\"\ldist: \"HashShard(t1.a)\"\l" ]
        25 [ label = "StreamHashJoin\lid: \"108\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        26 [ label = "StreamExchange\lid: \"104\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        27 [ label = "StreamHashJoin\lid: \"103\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        28 [ label = "StreamExchange\lid: \"101\"\ldist: \"HashShard(t1.a)\"\l" ]
        29 [ label = "StreamHashJoin\lid: \"100\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        30 [ label = "StreamExchange\lid: \"96\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        31 [ label = "StreamHashJoin\lid: \"95\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        32 [ label = "StreamExchange\lid: \"93\"\ldist: \"HashShard(t1.a)\"\l" ]
        33 [ label = "StreamHashJoin\lid: \"92\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        34 [ label = "StreamExchange\lid: \"88\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        35 [ label = "StreamHashJoin\lid: \"87\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        36 [ label = "StreamExchange\lid: \"85\"\ldist: \"HashShard(t1.a)\"\l" ]
        37 [ label = "StreamHashJoin\lid: \"84\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        38 [ label = "StreamExchange\lid: \"80\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        39 [ label = "StreamHashJoin\lid: \"79\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        40 [ label = "StreamExchange\lid: \"77\"\ldist: \"HashShard(t1.a)\"\l" ]
        41 [ label = "StreamHashJoin\lid: \"76\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        42 [ label = "StreamExchange\lid: \"72\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        43 [ label = "StreamHashJoin\lid: \"71\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        44 [ label = "StreamExchange\lid: \"69\"\ldist: \"HashShard(t1.a)\"\l" ]
        45 [ label = "StreamHashJoin\lid: \"68\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        46 [ label = "StreamExchange\lid: \"64\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        47 [ label = "StreamHashJoin\lid: \"63\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        48 [ label = "StreamExchange\lid: \"61\"\ldist: \"HashShard(t1.a)\"\l" ]
        49 [ label = "StreamHashJoin\lid: \"60\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        50 [ label = "StreamExchange\lid: \"56\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        51 [ label = "StreamHashJoin\lid: \"55\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        52 [ label = "StreamExchange\lid: \"53\"\ldist: \"HashShard(t1.a)\"\l" ]
        53 [ label = "StreamHashJoin\lid: \"52\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        54 [ label = "StreamExchange\lid: \"48\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        55 [ label = "StreamHashJoin\lid: \"47\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        56 [ label = "StreamExchange\lid: \"45\"\ldist: \"HashShard(t1.a)\"\l" ]
        57 [ label = "StreamHashJoin\lid: \"44\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        58 [ label = "StreamExchange\lid: \"40\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        59 [ label = "StreamHashJoin\lid: \"39\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        60 [ label = "StreamExchange\lid: \"37\"\ldist: \"HashShard(t1.a)\"\l" ]
        61 [ label = "StreamHashJoin\lid: \"36\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        62 [ label = "StreamExchange\lid: \"32\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        63 [ label = "StreamHashJoin\lid: \"31\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        64 [ label = "StreamExchange\lid: \"29\"\ldist: \"HashShard(t1.a)\"\l" ]
        65 [ label = "StreamHashJoin\lid: \"28\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        66 [ label = "StreamExchange\lid: \"24\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        67 [ label = "StreamHashJoin\lid: \"23\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        68 [ label = "StreamExchange\lid: \"21\"\ldist: \"HashShard(t1.a)\"\l" ]
        69 [ label = "StreamHashJoin\lid: \"20\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        70 [ label = "StreamExchange\lid: \"16\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        71 [ label = "StreamHashJoin\lid: \"15\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        72 [ label = "StreamExchange\lid: \"13\"\ldist: \"HashShard(t1.a)\"\l" ]
        73 [ label = "StreamHashJoin\lid: \"12\"\ltype: \"Inner\"\lpredicate: \"t1.a IS NOT DISTINCT FROM t1.a AND t1.b IS NOT DISTINCT FROM t1.b\"\l" ]
        74 [ label = "StreamExchange\lid: \"8\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        75 [ label = "StreamHashJoin\lid: \"7\"\ltype: \"Inner\"\lpredicate: \"t1.a = t2.c\"\l" ]
        76 [ label = "StreamExchange\lid: \"5\"\ldist: \"HashShard(t1.a)\"\l" ]
        77 [ label = "StreamProject\lid: \"4\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        78 [ label = "StreamHashAgg\lid: \"3\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        79 [ label = "StreamExchange\lid: \"2\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        80 [ label = "StreamTableScan\lid: \"12199\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        81 [ label = "StreamExchange\lid: \"6\"\ldist: \"HashShard(t2.c)\"\l" ]
        82 [ label = "StreamTableScan\lid: \"12205\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        83 [ label = "StreamProject\lid: \"11\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        84 [ label = "StreamHashAgg\lid: \"10\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        85 [ label = "StreamExchange\lid: \"9\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        86 [ label = "StreamTableScan\lid: \"12212\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        87 [ label = "StreamExchange\lid: \"14\"\ldist: \"HashShard(t2.c)\"\l" ]
        88 [ label = "StreamTableScan\lid: \"12219\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        89 [ label = "StreamProject\lid: \"19\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        90 [ label = "StreamHashAgg\lid: \"18\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        91 [ label = "StreamExchange\lid: \"17\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        92 [ label = "StreamTableScan\lid: \"12226\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        93 [ label = "StreamExchange\lid: \"22\"\ldist: \"HashShard(t2.c)\"\l" ]
        94 [ label = "StreamTableScan\lid: \"12233\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        95 [ label = "StreamProject\lid: \"27\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        96 [ label = "StreamHashAgg\lid: \"26\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        97 [ label = "StreamExchange\lid: \"25\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        98 [ label = "StreamTableScan\lid: \"12240\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        99 [ label = "StreamExchange\lid: \"30\"\ldist: \"HashShard(t2.c)\"\l" ]
        100 [ label = "StreamTableScan\lid: \"12247\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        101 [ label = "StreamProject\lid: \"35\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        102 [ label = "StreamHashAgg\lid: \"34\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        103 [ label = "StreamExchange\lid: \"33\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        104 [ label = "StreamTableScan\lid: \"12254\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        105 [ label = "StreamExchange\lid: \"38\"\ldist: \"HashShard(t2.c)\"\l" ]
        106 [ label = "StreamTableScan\lid: \"12261\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        107 [ label = "StreamProject\lid: \"43\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        108 [ label = "StreamHashAgg\lid: \"42\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        109 [ label = "StreamExchange\lid: \"41\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        110 [ label = "StreamTableScan\lid: \"12268\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        111 [ label = "StreamExchange\lid: \"46\"\ldist: \"HashShard(t2.c)\"\l" ]
        112 [ label = "StreamTableScan\lid: \"12275\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        113 [ label = "StreamProject\lid: \"51\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        114 [ label = "StreamHashAgg\lid: \"50\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        115 [ label = "StreamExchange\lid: \"49\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        116 [ label = "StreamTableScan\lid: \"12282\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        117 [ label = "StreamExchange\lid: \"54\"\ldist: \"HashShard(t2.c)\"\l" ]
        118 [ label = "StreamTableScan\lid: \"12289\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        119 [ label = "StreamProject\lid: \"59\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        120 [ label = "StreamHashAgg\lid: \"58\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        121 [ label = "StreamExchange\lid: \"57\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        122 [ label = "StreamTableScan\lid: \"12296\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        123 [ label = "StreamExchange\lid: \"62\"\ldist: \"HashShard(t2.c)\"\l" ]
        124 [ label = "StreamTableScan\lid: \"12303\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        125 [ label = "StreamProject\lid: \"67\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        126 [ label = "StreamHashAgg\lid: \"66\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        127 [ label = "StreamExchange\lid: \"65\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        128 [ label = "StreamTableScan\lid: \"12310\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        129 [ label = "StreamExchange\lid: \"70\"\ldist: \"HashShard(t2.c)\"\l" ]
        130 [ label = "StreamTableScan\lid: \"12317\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        131 [ label = "StreamProject\lid: \"75\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        132 [ label = "StreamHashAgg\lid: \"74\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        133 [ label = "StreamExchange\lid: \"73\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        134 [ label = "StreamTableScan\lid: \"12324\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        135 [ label = "StreamExchange\lid: \"78\"\ldist: \"HashShard(t2.c)\"\l" ]
        136 [ label = "StreamTableScan\lid: \"12331\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        137 [ label = "StreamProject\lid: \"83\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        138 [ label = "StreamHashAgg\lid: \"82\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        139 [ label = "StreamExchange\lid: \"81\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        140 [ label = "StreamTableScan\lid: \"12338\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        141 [ label = "StreamExchange\lid: \"86\"\ldist: \"HashShard(t2.c)\"\l" ]
        142 [ label = "StreamTableScan\lid: \"12345\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        143 [ label = "StreamProject\lid: \"91\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        144 [ label = "StreamHashAgg\lid: \"90\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        145 [ label = "StreamExchange\lid: \"89\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        146 [ label = "StreamTableScan\lid: \"12352\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        147 [ label = "StreamExchange\lid: \"94\"\ldist: \"HashShard(t2.c)\"\l" ]
        148 [ label = "StreamTableScan\lid: \"12359\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        149 [ label = "StreamProject\lid: \"99\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        150 [ label = "StreamHashAgg\lid: \"98\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        151 [ label = "StreamExchange\lid: \"97\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        152 [ label = "StreamTableScan\lid: \"12366\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        153 [ label = "StreamExchange\lid: \"102\"\ldist: \"HashShard(t2.c)\"\l" ]
        154 [ label = "StreamTableScan\lid: \"12373\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        155 [ label = "StreamProject\lid: \"107\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        156 [ label = "StreamHashAgg\lid: \"106\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        157 [ label = "StreamExchange\lid: \"105\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        158 [ label = "StreamTableScan\lid: \"12380\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        159 [ label = "StreamExchange\lid: \"110\"\ldist: \"HashShard(t2.c)\"\l" ]
        160 [ label = "StreamTableScan\lid: \"12387\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        161 [ label = "StreamProject\lid: \"115\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        162 [ label = "StreamHashAgg\lid: \"114\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        163 [ label = "StreamExchange\lid: \"113\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        164 [ label = "StreamTableScan\lid: \"12394\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        165 [ label = "StreamExchange\lid: \"118\"\ldist: \"HashShard(t2.c)\"\l" ]
        166 [ label = "StreamTableScan\lid: \"12401\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        167 [ label = "StreamProject\lid: \"123\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        168 [ label = "StreamHashAgg\lid: \"122\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        169 [ label = "StreamExchange\lid: \"121\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        170 [ label = "StreamTableScan\lid: \"12408\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        171 [ label = "StreamExchange\lid: \"126\"\ldist: \"HashShard(t2.c)\"\l" ]
        172 [ label = "StreamTableScan\lid: \"12415\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        173 [ label = "StreamProject\lid: \"131\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        174 [ label = "StreamHashAgg\lid: \"130\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        175 [ label = "StreamExchange\lid: \"129\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        176 [ label = "StreamTableScan\lid: \"12422\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        177 [ label = "StreamExchange\lid: \"134\"\ldist: \"HashShard(t2.c)\"\l" ]
        178 [ label = "StreamTableScan\lid: \"12429\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        179 [ label = "StreamProject\lid: \"139\"\lexprs: [\"t1.a\",\"t1.b\"]\l" ]
        180 [ label = "StreamHashAgg\lid: \"138\"\lgroup_key: [\"t1.a\",\"t1.b\"]\laggs: [\"count\"]\l" ]
        181 [ label = "StreamExchange\lid: \"137\"\ldist: \"HashShard(t1.a, t1.b)\"\l" ]
        182 [ label = "StreamTableScan\lid: \"12436\"\ltable: \"t1\"\lcolumns: [\"a\",\"b\",\"_row_id\"]\l" ]
        183 [ label = "StreamExchange\lid: \"142\"\ldist: \"HashShard(t2.c)\"\l" ]
        184 [ label = "StreamTableScan\lid: \"12443\"\ltable: \"t2\"\lcolumns: [\"c\"]\l" ]
        0 -> 1 [ ]
        1 -> 2 [ ]
        2 -> 3 [ ]
        3 -> 4 [ ]
        2 -> 5 [ ]
        5 -> 6 [ ]
        6 -> 7 [ ]
        7 -> 8 [ ]
        8 -> 9 [ ]
        9 -> 10 [ ]
        10 -> 11 [ ]
        11 -> 12 [ ]
        12 -> 13 [ ]
        13 -> 14 [ ]
        14 -> 15 [ ]
        15 -> 16 [ ]
        16 -> 17 [ ]
        17 -> 18 [ ]
        18 -> 19 [ ]
        19 -> 20 [ ]
        20 -> 21 [ ]
        21 -> 22 [ ]
        22 -> 23 [ ]
        23 -> 24 [ ]
        24 -> 25 [ ]
        25 -> 26 [ ]
        26 -> 27 [ ]
        27 -> 28 [ ]
        28 -> 29 [ ]
        29 -> 30 [ ]
        30 -> 31 [ ]
        31 -> 32 [ ]
        32 -> 33 [ ]
        33 -> 34 [ ]
        34 -> 35 [ ]
        35 -> 36 [ ]
        36 -> 37 [ ]
        37 -> 38 [ ]
        38 -> 39 [ ]
        39 -> 40 [ ]
        40 -> 41 [ ]
        41 -> 42 [ ]
        42 -> 43 [ ]
        43 -> 44 [ ]
        44 -> 45 [ ]
        45 -> 46 [ ]
        46 -> 47 [ ]
        47 -> 48 [ ]
        48 -> 49 [ ]
        49 -> 50 [ ]
        50 -> 51 [ ]
        51 -> 52 [ ]
        52 -> 53 [ ]
        53 -> 54 [ ]
        54 -> 55 [ ]
        55 -> 56 [ ]
        56 -> 57 [ ]
        57 -> 58 [ ]
        58 -> 59 [ ]
        59 -> 60 [ ]
        60 -> 61 [ ]
        61 -> 62 [ ]
        62 -> 63 [ ]
        63 -> 64 [ ]
        64 -> 65 [ ]
        65 -> 66 [ ]
        66 -> 67 [ ]
        67 -> 68 [ ]
        68 -> 69 [ ]
        69 -> 70 [ ]
        70 -> 71 [ ]
        71 -> 72 [ ]
        72 -> 73 [ ]
        73 -> 74 [ ]
        74 -> 75 [ ]
        75 -> 76 [ ]
        76 -> 77 [ ]
        77 -> 78 [ ]
        78 -> 79 [ ]
        79 -> 80 [ ]
        75 -> 81 [ ]
        81 -> 82 [ ]
        73 -> 83 [ ]
        83 -> 84 [ ]
        84 -> 85 [ ]
        85 -> 86 [ ]
        71 -> 87 [ ]
        87 -> 88 [ ]
        69 -> 89 [ ]
        89 -> 90 [ ]
        90 -> 91 [ ]
        91 -> 92 [ ]
        67 -> 93 [ ]
        93 -> 94 [ ]
        65 -> 95 [ ]
        95 -> 96 [ ]
        96 -> 97 [ ]
        97 -> 98 [ ]
        63 -> 99 [ ]
        99 -> 100 [ ]
        61 -> 101 [ ]
        101 -> 102 [ ]
        102 -> 103 [ ]
        103 -> 104 [ ]
        59 -> 105 [ ]
        105 -> 106 [ ]
        57 -> 107 [ ]
        107 -> 108 [ ]
        108 -> 109 [ ]
        109 -> 110 [ ]
        55 -> 111 [ ]
        111 -> 112 [ ]
        53 -> 113 [ ]
        113 -> 114 [ ]
        114 -> 115 [ ]
        115 -> 116 [ ]
        51 -> 117 [ ]
        117 -> 118 [ ]
        49 -> 119 [ ]
        119 -> 120 [ ]
        120 -> 121 [ ]
        121 -> 122 [ ]
        47 -> 123 [ ]
        123 -> 124 [ ]
        45 -> 125 [ ]
        125 -> 126 [ ]
        126 -> 127 [ ]
        127 -> 128 [ ]
        43 -> 129 [ ]
        129 -> 130 [ ]
        41 -> 131 [ ]
        131 -> 132 [ ]
        132 -> 133 [ ]
        133 -> 134 [ ]
        39 -> 135 [ ]
        135 -> 136 [ ]
        37 -> 137 [ ]
        137 -> 138 [ ]
        138 -> 139 [ ]
        139 -> 140 [ ]
        35 -> 141 [ ]
        141 -> 142 [ ]
        33 -> 143 [ ]
        143 -> 144 [ ]
        144 -> 145 [ ]
        145 -> 146 [ ]
        31 -> 147 [ ]
        147 -> 148 [ ]
        29 -> 149 [ ]
        149 -> 150 [ ]
        150 -> 151 [ ]
        151 -> 152 [ ]
        27 -> 153 [ ]
        153 -> 154 [ ]
        25 -> 155 [ ]
        155 -> 156 [ ]
        156 -> 157 [ ]
        157 -> 158 [ ]
        23 -> 159 [ ]
        159 -> 160 [ ]
        21 -> 161 [ ]
        161 -> 162 [ ]
        162 -> 163 [ ]
        163 -> 164 [ ]
        19 -> 165 [ ]
        165 -> 166 [ ]
        17 -> 167 [ ]
        167 -> 168 [ ]
        168 -> 169 [ ]
        169 -> 170 [ ]
        15 -> 171 [ ]
        171 -> 172 [ ]
        13 -> 173 [ ]
        173 -> 174 [ ]
        174 -> 175 [ ]
        175 -> 176 [ ]
        11 -> 177 [ ]
        177 -> 178 [ ]
        9 -> 179 [ ]
        179 -> 180 [ ]
        180 -> 181 [ ]
        181 -> 182 [ ]
        7 -> 183 [ ]
        183 -> 184 [ ]
    }
- name: test dot output format (distsql, stream)
  sql: |
    CREATE TABLE t (v1 int);
    explain (distsql, format dot) create materialized view m1 as SELECT approx_percentile(0.5) WITHIN GROUP (order by v1) from t;
  explain_output: |
    digraph {
        0 [ label = "Fragment 0\l" ]
        1 [ label = "StreamMaterialize { columns: [approx_percentile], stream_key: [], pk_columns: [], pk_conflict: NoCheck }\ltables: [\"Materialize: 4294967294\"]\l" ]
        2 [ label = "StreamGlobalApproxPercentile { quantile: 0.5:Float64, relative_error: 0.01:Float64 }\ltables: [\"GlobalApproxPercentileBucketState: 0\",\"GlobalApproxPercentileCountState: 1\"]\l" ]
        3 [ label = "StreamExchange Single from 1" ]
        4 [ label = "Fragment 1\l" ]
        5 [ label = "StreamLocalApproxPercentile { percentile_col: $expr1, quantile: 0.5:Float64, relative_error: 0.01:Float64 }" ]
        6 [ label = "StreamProject { exprs: [t.v1::Float64 as $expr1, t._row_id] }" ]
        7 [ label = "StreamTableScan { table: t, columns: [v1, _row_id] }\ltables: [\"StreamScan: 2\"]\l" ]
        8 [ label = "Upstream" ]
        9 [ label = "BatchPlanNode" ]
        10 [ label = "Table 0\lcolumns: [\"sign\",\"bucket_id\",\"count\",\"_rw_timestamp\"]\lprimary key: [\"$0 ASC\",\"$1 ASC\"]\lvalue indices: [\"0\",\"1\",\"2\"]\ldistribution key: []\lread pk prefix len hint: \"0\"\l" ]
        11 [ label = "Table 1\lcolumns: [\"total_count\",\"_rw_timestamp\"]\lprimary key: []\lvalue indices: [\"0\"]\ldistribution key: []\lread pk prefix len hint: \"0\"\l" ]
        12 [ label = "Table 2\lcolumns: [\"vnode\",\"_row_id\",\"backfill_finished\",\"row_count\",\"_rw_timestamp\"]\lprimary key: [\"$0 ASC\"]\lvalue indices: [\"1\",\"2\",\"3\"]\ldistribution key: [\"0\"]\lread pk prefix len hint: \"1\"\lvnode column idx: \"0\"\l" ]
        13 [ label = "Table 4294967294\lcolumns: [\"approx_percentile\",\"_rw_timestamp\"]\lprimary key: []\lvalue indices: [\"0\"]\ldistribution key: []\lread pk prefix len hint: \"0\"\l" ]
        0 -> 1 [ label = "" ]
        1 -> 2 [ label = "" ]
        2 -> 3 [ label = "" ]
        4 -> 5 [ label = "" ]
        5 -> 6 [ label = "" ]
        6 -> 7 [ label = "" ]
        7 -> 8 [ label = "" ]
        7 -> 9 [ label = "" ]
    }

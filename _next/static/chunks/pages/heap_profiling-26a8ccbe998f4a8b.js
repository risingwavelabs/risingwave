(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{84808:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/heap_profiling",function(){return t(88098)}])},95161:function(e,n,t){"use strict";t.d(n,{OL:function(){return a},X8:function(){return o},dL:function(){return c},xv:function(){return i}});var l=t(56250),r=t(29286);async function o(){return await r.ZP.get("/metrics/cluster")}async function i(){return(await r.ZP.get("/clusters/1")).map(l.cX.fromJSON)}async function a(){return(await r.ZP.get("/clusters/2")).map(l.cX.fromJSON)}async function c(){return await r.ZP.get("/version")}},3047:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var l=t(67294),r=t(51388);function o(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[o,i]=(0,l.useState)(),a=(0,r.Z)();return(0,l.useEffect)(()=>{let l=async()=>{if(t)try{let n=await e();i(n)}catch(e){a(e)}};if(l(),!n)return;let r=setInterval(l,n);return()=>clearInterval(r)},[a,n,t]),{response:o}}},88098:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var l=t(85893),r=t(40639),o=t(83234),i=t(57026),a=t(47741),c=t(63764),s=t(45772),u=t.n(s),d=t(9008),f=t.n(d),h=t(1864),p=t.n(h),g=t(67294),m=t(88773),x=t(9864),j=t(56103),v=t(29286),w=t(95161),y=t(3047),P=t(35049);function C(){let{response:e}=(0,y.Z)(w.OL),[n,t]=(0,g.useState)(),[s,d]=(0,g.useState)(""),[h,C]=(0,g.useState)(),[_,E]=(0,g.useState)(),[N,Z]=(0,g.useState)("Auto"),[b,S]=(0,g.useState)();async function X(e,n){if(e&&n&&e.length>0)try{let e=P.R_.fromJSON(await v.ZP.get("/monitor/list_heap_profile/".concat(n)));C(e)}catch(e){console.error(e),d("Getting Profiling File List\n\nError: ".concat(e.message,"\n").concat(e.cause))}}async function k(){try{await v.ZP.get("/monitor/dump_heap_profile/".concat(n)),X(e,n)}catch(e){d("Dumping heap profile.\n\nError: ".concat(e.message,"\n").concat(e.cause))}}async function z(){let e;if(void 0===_||void 0===b){console.log("selectedProfileList: ".concat(_,", analyzeTargetFileName: ").concat(b));return}let t=p().join(_.dir,b);d("Analyzing ".concat(b," from Compute Node ").concat(n));let l="Collapsed Profiling of Compute Node ".concat(n," for ").concat(b);try{let r=u()(t),o=await fetch("/monitor/analyze/".concat(n,"/").concat(r)).then(async e=>({filename:e.headers.get("content-disposition"),blob:await e.blob()})),i=window.URL.createObjectURL(o.blob),a=document.createElement("a");a.href=i,a.download=o.filename||(0,m.Z)(),a.click(),e="".concat(l,"\n\nDownloaded!")}catch(n){e="".concat(l,"\n\nError: ").concat(n.message)}d(e)}(0,g.useEffect)(()=>{e&&!n&&e.length>0&&t(e[0].id)},[e,n]),(0,g.useEffect)(()=>{X(e,n)},[e,n]),(0,g.useEffect)(()=>{h&&("Auto"===N?E({dir:h.dir,name:h.nameAuto}):"Manually"===N?E({dir:h.dir,name:h.nameManually}):console.error("Bad profileType ".concat(N)))},[N,h]),(0,g.useEffect)(()=>{_&&_.name.length>0&&S(_.name[0])},[_]);let O=(0,l.jsxs)(r.kC,{p:3,height:"calc(50vh - 20px)",flexDirection:"column",children:[(0,l.jsx)(j.Z,{children:"Heap Profiling"}),(0,l.jsxs)(r.kC,{flexDirection:"row",height:"full",width:"full",children:[(0,l.jsxs)(r.gC,{mr:3,spacing:3,alignItems:"flex-start",width:200,height:"full",children:[(0,l.jsxs)(o.NI,{children:[(0,l.jsx)(o.lX,{textColor:"blue.500",children:"Dump Heap Profile"}),(0,l.jsxs)(r.gC,{children:[(0,l.jsx)(o.lX,{children:"Compute Nodes"}),(0,l.jsx)(i.Ph,{onChange:e=>t(parseInt(e.target.value)),children:e&&e.map(e=>{var n,t;return(0,l.jsxs)("option",{value:e.id,children:["(",e.id,") ",null===(n=e.host)||void 0===n?void 0:n.host,":",null===(t=e.host)||void 0===t?void 0:t.port]},e.id)})}),(0,l.jsx)(a.zx,{onClick:e=>k(),width:"full",children:"Dump"})]})]}),(0,l.jsxs)(o.NI,{children:[(0,l.jsx)(o.lX,{textColor:"blue.500",children:"Analyze Heap Profile"}),(0,l.jsxs)(r.gC,{children:[(0,l.jsx)(o.lX,{children:"Dumped By"}),(0,l.jsx)(i.Ph,{onChange:e=>Z(e.target.value),children:["Auto","Manually"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(o.lX,{children:"Dumped Files"}),(0,l.jsx)(i.Ph,{onChange:e=>S(e.target.value),children:_&&_.name.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(a.zx,{onClick:e=>z(),width:"full",children:"Analyze"})]})]})]}),(0,l.jsx)(r.xu,{flex:1,height:"full",ml:3,overflowX:"scroll",overflowY:"scroll",children:void 0===s?(0,l.jsx)(x.Z,{}):(0,l.jsx)(c.ZP,{language:"sql",options:{fontSize:13,readOnly:!0,renderWhitespace:"boundary",wordWrap:"on"},defaultValue:'Select a compute node and target profiling result file and click "Analyze"...',value:s})})]})]});return(0,l.jsxs)(g.Fragment,{children:[(0,l.jsx)(f(),{children:(0,l.jsx)("title",{children:"Heap Profiling"})}),O]})}}},function(e){e.O(0,[876,877,851,49,888,774,179],function(){return e(e.s=84808)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[695],{69850:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cluster",function(){return n(67775)}])},95161:function(e,t,n){"use strict";n.d(t,{OL:function(){return c},X8:function(){return s},dL:function(){return l},xv:function(){return a}});var r=n(56250),i=n(29286);async function s(){return await i.ZP.get("/metrics/cluster")}async function a(){return(await i.ZP.get("/clusters/1")).map(r.cX.fromJSON)}async function c(){return(await i.ZP.get("/clusters/2")).map(r.cX.fromJSON)}async function l(){return await i.ZP.get("/version")}},67775:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var r=n(85893),i=n(40639),s=n(52189),a=n(66678),c=n.n(a),l=n(31351),o=n.n(l),u=n(89734),d=n.n(u),m=n(9008),h=n.n(m),x=n(67294),f=n(46464),p=n(86231),j=n(25615),w=n(88793),g=n(55400),y=n(56103),b=n(51388),v=n(95161);function C(e){var t,n;let{workerNodeType:s,workerNode:a}=e;return(0,r.jsx)(x.Fragment,{children:(0,r.jsxs)(i.gC,{alignItems:"start",spacing:1,children:[(0,r.jsxs)(i.Ug,{children:[(0,r.jsx)(i.xu,{w:3,h:3,flex:"none",bgColor:"green.600",rounded:"full"}),(0,r.jsxs)(i.xv,{fontWeight:"medium",fontSize:"xl",textColor:"black",children:[s," #",a.id]})]}),(0,r.jsx)(i.xv,{textColor:"gray.500",m:0,children:"Running"}),(0,r.jsxs)(i.xv,{textColor:"gray.500",m:0,children:[null===(t=a.host)||void 0===t?void 0:t.host,":",null===(n=a.host)||void 0===n?void 0:n.port]})]})})}function k(e){let{job:t,instance:n,metrics:a,isCpuMetrics:l}=e,u=(0,x.useCallback)(()=>{let e=[];if(0===a.length)return[];let t=a.at(-1).timestamp;for(let n of o()(c()(a))){for(;t-n.timestamp>0;)t-=60,e.push({timestamp:t,value:0});e.push(n),t-=60}for(;e.length<60;)e.push({timestamp:t,value:0}),t-=60;return o()(e)},[a]);return(0,r.jsx)(x.Fragment,{children:(0,r.jsxs)(i.gC,{alignItems:"start",spacing:1,children:[(0,r.jsxs)(i.xv,{textColor:"gray.500",mx:3,children:[(0,r.jsx)("b",{children:t})," ",n]}),(0,r.jsx)(f.h,{width:"100%",height:100,children:(0,r.jsxs)(p.T,{data:u(),children:[(0,r.jsx)(j.K,{dataKey:"timestamp",type:"number",domain:["dataMin","dataMax"],hide:!0}),l&&(0,r.jsx)(w.B,{type:"number",domain:[0,1],hide:!0}),(0,r.jsx)(g.u,{isAnimationActive:!1,type:"linear",dataKey:"value",strokeWidth:1,stroke:s.rS.colors.blue["500"],fill:s.rS.colors.blue["100"]})]})})]})})}function P(){let[e,t]=(0,x.useState)([]),[n,s]=(0,x.useState)([]),[a,c]=(0,x.useState)(),[l,o]=(0,x.useState)(),u=(0,b.Z)();(0,x.useEffect)(()=>((async function(){try{t(await (0,v.xv)()),s(await (0,v.OL)()),o(await (0,v.dL)())}catch(e){u(e)}})(),()=>{}),[u]),(0,x.useEffect)(()=>((async function(){for(;;)try{let e=await (0,v.X8)();e.cpuData=d()(e.cpuData,e=>e.metric.instance),e.memoryData=d()(e.memoryData,e=>e.metric.instance),c(e),await new Promise(e=>setTimeout(e,5e3))}catch(e){u(e,"warning");break}})(),()=>{}),[u]);let m=(0,r.jsxs)(i.xu,{p:3,children:[(0,r.jsx)(y.Z,{children:"Cluster Overview"}),(0,r.jsxs)(i.xv,{textColor:"gray.500",m:0,children:["Version: ",l]}),(0,r.jsxs)(i.rj,{my:3,templateColumns:"repeat(3, 1fr)",gap:6,width:"full",children:[e.map(e=>(0,r.jsx)(i.P4,{w:"full",rounded:"xl",bg:"white",shadow:"md",borderWidth:1,p:6,children:(0,r.jsx)(C,{workerNodeType:"Frontend",workerNode:e})},e.id)),n.map(e=>(0,r.jsx)(i.P4,{w:"full",rounded:"xl",bg:"white",shadow:"md",borderWidth:1,p:6,children:(0,r.jsx)(C,{workerNodeType:"Compute",workerNode:e})},e.id))]}),(0,r.jsx)(y.Z,{children:"CPU Usage"}),(0,r.jsx)(i.MI,{my:3,columns:3,spacing:6,width:"full",children:a&&a.cpuData.map(e=>(0,r.jsx)(i.P4,{w:"full",rounded:"xl",bg:"white",shadow:"md",borderWidth:1,children:(0,r.jsx)(k,{job:e.metric.job,instance:e.metric.instance,metrics:e.sample,isCpuMetrics:!0})},e.metric.instance))}),(0,r.jsx)(y.Z,{children:"Memory Usage"}),(0,r.jsx)(i.MI,{my:3,columns:3,spacing:6,width:"full",children:a&&a.memoryData.map(e=>(0,r.jsx)(i.P4,{w:"full",rounded:"xl",bg:"white",shadow:"md",borderWidth:1,children:(0,r.jsx)(k,{job:e.metric.job,instance:e.metric.instance,metrics:e.sample,isCpuMetrics:!1})},e.metric.instance))})]});return(0,r.jsxs)(x.Fragment,{children:[(0,r.jsx)(h(),{children:(0,r.jsx)("title",{children:"Cluster Overview"})}),m]})}}},function(e){e.O(0,[184,240,287,851,888,774,179],function(){return e(e.s=69850)}),_N_E=e.O()}]);